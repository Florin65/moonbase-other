# Read the config so we can show the user
. $MODULE_CONFIG

GET_ADMIN=0
if ! grep -q "DELEGATE_ADMIN" $MODULE_CONFIG; then
  if query "Change delegate admin (root@`uname -n`)?" n; then
    GET_ADMIN=1
  else
    DELEGATE_ADMIN="root@`uname -n`"
    echo "DELEGATE_ADMIN=$DELEGATE_ADMIN" >> $MODULE_CONFIG
  fi
else
  if query "Change delegate admin ($DELEGATE_ADMIN)?" n; then
    GET_ADMIN=1
  fi
fi

if [ "$GET_ADMIN" == "1" ]; then
  IS_THIS_CORRECT=0
  while [ "$IS_THIS_CORRECT" == "0" ]; do
    echo -en "${MODULE_COLOR}${MODULE}${DEFAULT_COLOR}:  ${QUERY_COLOR}Enter admin email:${DEFAULT_COLOR} "
    read -e DELEGATE_ADMIN
    if [ "$DELEGATE_ADMIN" == "" ]; then
      message "${MODULE_COLOR}${MODULE}:${PROBLEM_COLOR} ! Error: Delegate admin cannot be blank${DEFAULT_COLOR}"
    else
      if query "Is '$DELEGATE_ADMIN' correct?" y; then
        IS_THIS_CORRECT=1
      fi
    fi
  done
  echo "DELEGATE_ADMIN=$DELEGATE_ADMIN" >> $MODULE_CONFIG
fi
